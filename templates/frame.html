<!DOCTYPE html>
<html>

<head>
    <title>Frame</title>
    <style type="text/css">
    * {
        cursor: none
    }
    
    html,
    body {
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        background-color: #000;
    }
    
    body {
        background-repeat: no-repeat;
        background-position: center center;
        background-size: cover;
    }
    </style>
</head>

<body>
    <div id="Video" style="position: fixed; width: 100%; height: 100%; display: none;">
        <iframe frameborder="0" height="100%" width="100%" src="https://youtube.com/embed/ID?autoplay=1&controls=0&showinfo=0&autohide=1">
        </iframe>
    </div>

    <script type="text/javascript" src="/static/js/libs/jquery-2.1.3.js"></script>
    <script type="text/javascript">
    var $body = $('body'),
        user = 'jonwohl',
        domain = url_domain(window.location);;

    if (window.location.hash) {
        user = window.location.hash.substring(1);
        console.log(user);
    }
    var ws = new WebSocket("ws://" + domain + ":8888/ws/" + user);
    ws.onopen = function() {
        ws.send("connecting as " + user);
    };
    ws.onmessage = function(evt) {
        var data = JSON.parse(evt.data);
        console.log(data);
        if (data.type && data.url) {
            switch (data.type) {
                case 'image':
                    $('#Video').hide();
                     $('iframe').attr('src', null);
                    $body.css({
                        'background-image': 'url("' + data.url + '")'
                    });
                case 'youtube':
                    // https://www.youtube.com/watch?v=x-rIe1sCJU4
                    var vid = data.url.match(/v=(.*)/);
                    console.log(vid);
                    var url = 'https://youtube.com/embed/' + vid[1] + '?autoplay=1&controls=0&showinfo=0&autohide=1'
                    $('#Video').show();
                    $('iframe').attr('src', url);
            }
        }
    };

    ws.onclose = function(evt) {
        // attempt to re-open connection
        var ws = new WebSocket("ws://" + domain + ":8888/ws/" + user);
    };

    function url_domain(data) {
        var a = document.createElement('a');
        a.href = data;
        return a.hostname;
    }
    </script>
</body>

</html>
